<div class="dashboard-container">
  <h2>Welcome to Your Dashboard</h2>

  <div class="overview">
    <h3>Financial Overview</h3>

    <!-- Financial data charts with conditions to check if data is available -->
    <div class="charts">
      <!-- Income Chart -->
      <div class="chart">
        <h4>Income</h4>
        <div *ngIf="income === undefined || income.length === 0">
          <p>No income to show.</p>
        </div>

        <div *ngIf="income && income.length > 0">
          <ul>
            <li *ngFor="let incomeItem of income">
              <strong>{{ incomeItem.source }}:</strong> ₤
              {{ incomeItem.amount }}
              <button (click)="deleteIncome(incomeItem._id)">Delete</button>
            </li>
          </ul>

          <!-- Display total income -->
          <div class="total-income">
            <strong>Total Income: </strong> ₤ {{ totalIncome }}
          </div>
        </div>
      </div>

      <!-- Expenses Chart -->
      <div class="chart">
        <h4>Expenses</h4>
        <div *ngIf="expenses === undefined; else expenseList">
          <p>Loading...</p>
        </div>
        <ng-template #expenseList>
          <div *ngIf="expenses.length === 0">
            <p>No expenses to show.</p>
          </div>

          <ul *ngIf="expenses.length > 0">
            <li *ngFor="let expense of expenses">
              <strong>{{ expense.category }}:</strong> ₤ {{ expense.amount }} -
              {{ expense.description }}
              <button (click)="deleteExpense(expense._id)">Delete</button>
            </li>
          </ul>
        </ng-template>
      </div>

      <!-- Savings Goal Chart -->
      <div class="chart">
        <h4>Savings Goal</h4>
        <p *ngIf="savingsGoal !== undefined; else loadingGoal">
          ₤ {{ savingsGoal }}
        </p>
        <ng-template #loadingGoal>
          <p>Loading...</p>
        </ng-template>
      </div>
    </div>
  </div>

  <div class="actions">
    <h3>Add New Data</h3>

    <!-- Add Expense Form -->
    <form (ngSubmit)="addExpense()">
      <label for="category">Category</label>
      <input
        type="text"
        [(ngModel)]="newExpense.category"
        name="category"
        required
      />
      <label for="amount">Amount</label>
      <input
        type="number"
        [(ngModel)]="newExpense.amount"
        name="amount"
        required
      />
      <label for="description">Description</label>
      <input
        type="text"
        [(ngModel)]="newExpense.description"
        name="description"
        required
      />
      <button type="submit">Add Expense</button>
    </form>

    <!-- Add Income Form -->
    <form (ngSubmit)="addIncome()">
      <label for="source">Income Source:</label>
      <input
        type="text"
        id="source"
        [(ngModel)]="newIncome.source"
        name="source"
        required
      />
      <label for="amount">Amount:</label>
      <input
        type="number"
        id="amount"
        [(ngModel)]="newIncome.amount"
        name="amount"
        required
      />
      <button type="submit">Add Income</button>
    </form>

    <!-- Add Savings Goal Form -->
    <form (ngSubmit)="addSavingsGoal()">
      <label for="goalName">Goal Name</label>
      <input
        type="text"
        [(ngModel)]="newSavingsGoal.goalName"
        name="goalName"
        required
      />
      <label for="targetAmount">Target Amount</label>
      <input
        type="number"
        [(ngModel)]="newSavingsGoal.targetAmount"
        name="targetAmount"
        required
      />
      <button type="submit">Add Goal</button>
    </form>
  </div>

  <!-- Report Generation Section -->
  <section>
    <h3>Generate Financial Report</h3>
    <button (click)="generateReport()">Generate Report</button>

    <div *ngIf="report">
      <h4>Report Summary</h4>
      <pre>{{ report | json }}</pre>
    </div>
  </section>
</div>
